<!--index.wxml-->
<view class="container">

  <loading hidden="{{finish}}">加载数据</loading>

  <loading hidden="{{finding}}">寻找数据</loading>

  <loading hidden="{{personal}}">进入个人主页</loading>

  <button class="userinfo-avatar" open-type="getUserInfo" bindgetuserinfo="onGetUserInfo" bindtap="onGetOpenid" style="background-image: url({{avatarUrl}})"/>

  <!-- top naviagtor page -->
    <scroll-view class="scroll_w" scroll-x >
      <view class="topContainer" wx:for="{{topNavi}}">
          <view class="top-item" bindtap="topOntap" data-item="{{item}}">
            <text class="top-text">{{item}}</text>
          </view>
      </view>
    </scroll-view> 
  
  <!-- Car Page -->
  <view class="itemTemplate" wx:if="{{page == 1}}">
    <picker class="row" mode="date" value="{{date}}" start="{{nowDate}}" end="{{endDate}}" bindchange="carselectDate">
          <image class="icon" src="../../images/calendar.png"/>
          <Text class="text">{{date}}</Text>
        </picker>

        <picker class="row" mode="multiSelector" bindchange="carselectLocation" bindcolumnchange="To do later" value="{{mulloc}}" range="{{mulloc}}">
          <image class="icon" src="../../images/location.png"/>
          <Text class="text">{{cfrom}} - {{cto}}</Text>
        </picker>

        <radio-group name="radio-group" bindchange="carselectType">
          <image class="icon" src="../../images/project.png"/>
          <label><radio class="text" value="找车" checked="true"/>找车</label>
          <label><radio class="text" value="找人"/>找人</label>
        </radio-group>

        <view class="carBottom">
            <button class="item-left-find" type="primary" plain="false" bindtap="onFind">Find</button>
            <navigator url="../createData/createData?date={{date}}&from={{cfrom}}&to={{cto}}&carType={{carType}}&type={{1}}" hover-class="none">
              <button class="item-right-add" type="primary" plain="false">Add</button>
            </navigator>
            
        </view>
  </view>

  <view class="itemTemplate" wx:for="{{carlist}}" wx:if="{{page == 1}}">
      <navigator url="../detailsPage/detailsPage?date={{item.date}}&from={{item.from}}&&to={{item.to}}&carType={{item.carType}}&type={{1}}">

            <view class="row">
              <image class="icon-car" src="../../images/calendar.png"/>
              <text class='item-car'>{{item.date}}</text>
            </view>
            <view class="row">
              <image class="icon-car" src="../../images/location.png"/>
              <text class="item-car">{{item.from}} - {{item.to}}</text>
            </view>

            <view class="carBottom">
                <view class='item-left'>
                  <image class="icon-car" src="../../images/project.png"/>
                  <text>{{item.carType}}</text>
                </view>

                <view class="item-right">
                    <image class="icon-car" src="../../images/user.png"/>
                    <text class="usr-count">{{item.count}}</text>
                </view>
            </view>

      </navigator>
  </view>
  <!-- <text class="itemTemplate" wx:if="{{page == 1 && carlist.length == 20}}">max carlist</text> -->

  <!-- Goods Page -->
  <view class="itemTemplate" wx:if="{{page == 2}}">
      
      <view class="good-con-page-section">
            <input class="good-text" bindinput="inputGoods" placeholder="物品" value="{{goods}}"/>
      </view>

      <view class="good-padding">
        <radio-group name="radio-group" bindchange="excselectType">
            <label><radio value="出售" checked="true"/>出售</label>
            <label><radio value="寻找"/>寻找</label>
        </radio-group>
      </view>
      
      <view class="carBottom">
            <button class="item-left-find" type="primary" plain="false" bindtap="onFind" data-type="2">Find</button>
            <navigator url="../createData/createData?goods={{goods}}&excType={{excType}}&type={{2}}" hover-class="none">
              <button class="item-right-add" type="primary" plain="false">Add</button>
            </navigator>  
      </view>
  </view>

  <view wx:for="{{exclist}}" wx:if="{{page == 2}}">
    <navigator url="../detailsPage/detailsPage?goods={{item.goods}}&excType={{item.excType}}&type={{2}}">
      <view class='itemTemplate'>

            <view class="row">
              <image class="icon-car" src="../../images/goods.png"/>
              <text class='item-car'>{{item.goods}}</text>
            </view>

            <view class="carBottom">
                <view class='item-left'>
                  <image class="icon-car" src="../../images/project.png"/>
                  <text>{{item.excType}}</text>
                </view>

                <view class="item-right">
                    <image class="icon-car" src="../../images/user.png"/>
                    <text class="usr-count">{{item.count}}</text>
                </view>
            </view>
      </view>
    </navigator>
  </view>
  <!-- <text class="itemTemplate" wx:if="{{page==2 && exclist.length == 20}}">max exclist</text> -->
  
  <!-- Que Page -->
  <scroll-view class="itemTemplate" wx:for="{{quelist}}" wx:if="{{page == 3}}" data-id="{{item._id}}" lower-threshold="200">
      <text class="questiontext">{{item.question}}</text>
  </scroll-view>

  <!-- <text class="itemTemplate" wx:if="{{page == 3 && quelist.length == 20}}">max quelist</text> -->

  <!-- Gap -->
  <view class="buttomGap">
  </view>
  
  <!-- Lower buttons page -->

  <view >
      <image bindtap = "toRightPage" class = "toRight" mode="aspectFit" src="../../images/toRight.png"></image>
  </view>

  <view bindtap="toChangePage" id="toPre" >
      <image class="toPrePage" src="../../images/toPre.png"></image>
  </view>

  <view bindtap = "toChangePage" id="toNext" >
      <image class="toNextPage" src="../../images/toNext.png"></image>
  </view>

  <navigator url='../createData/createData?type={{page}}'>
        <image class="createData" src="/images/addButton.png"></image>
  </navigator>


</view>
